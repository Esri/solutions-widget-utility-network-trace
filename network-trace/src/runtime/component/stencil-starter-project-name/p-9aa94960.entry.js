import{r as t,h as e,H as i,g as s,c as o}from"./p-551d452f.js";import{f as a,g as n}from"./p-ddb29161.js";import{g as r}from"./p-769235dc.js";import{C as l}from"./p-5b6c1e57.js";import{d as c,u as p,c as h,C as d}from"./p-1312f80e.js";import{g as m}from"./p-7b3393a7.js";import{T as u,A as f,P as b,a as x,C as g}from"./p-39a8d341.js";const v=["ArrowUp","ArrowDown"],y=["ArrowUp","ArrowDown","End","Home"],w=class{constructor(e){t(this,e),this.expanded=!1,this.offsetDistance=0,this.open=!1,this.placement="auto",this.actionElements=[],this.mutationObserver=new MutationObserver((()=>this.getActions())),this.guid="calcite-action-menu-"+r(),this.menuId=this.guid+"-menu",this.menuButtonId=this.guid+"-menu-button",this.activeMenuItemIndex=-1,this.menuButtonClick=()=>{this.toggleOpen()},this.setMenuButtonRef=t=>{this.menuButtonEl=t},this.updateAction=(t,e)=>{const{guid:i,activeMenuItemIndex:s}=this,o=`${i}-action-${e}`;t.tabIndex=-1,t.setAttribute("role","menuitem"),t.id||(t.id=o),t.active=e===s},this.updateActions=t=>{null==t||t.forEach(this.updateAction)},this.getActions=()=>{var t;const e=(null===(t=this.el.querySelector("slot"))||void 0===t?void 0:t.assignedElements({flatten:!0}).filter((t=>"CALCITE-ACTION"===t.tagName)))||[];this.updateActions(e),this.actionElements=e},this.menuButtonKeyUp=t=>{const{key:e}=t,{actionElements:i}=this;this.isValidKey(e,v)&&(t.preventDefault(),i.length&&(this.toggleOpen(!0),this.handleActionNavigation(e,i)))},this.menuButtonKeyDown=t=>{const{key:e}=t;this.isValidKey(e,v)&&t.preventDefault()},this.menuActionsContainerKeyDown=t=>{const{key:e}=t,{actionElements:i,activeMenuItemIndex:s}=this;if("Tab"!==e)if(" "!==e&&"Enter"!==e)this.isValidKey(e,y)&&t.preventDefault();else{t.preventDefault();const e=i[s];e?e.click():this.toggleOpen(!1)}else this.open=!1},this.menuActionsContainerKeyUp=t=>{const{key:e}=t,{actionElements:i}=this;"Escape"!==e?this.isValidKey(e,y)&&(t.preventDefault(),i.length&&this.handleActionNavigation(e,i)):this.toggleOpen(!1)},this.handleActionNavigation=(t,e)=>{const i=this.activeMenuItemIndex;"Home"===t&&(this.activeMenuItemIndex=0),"End"===t&&(this.activeMenuItemIndex=e.length-1),"ArrowUp"===t&&(this.activeMenuItemIndex=m(Math.max(i-1,-1),e.length)),"ArrowDown"===t&&(this.activeMenuItemIndex=m(i+1,e.length))},this.toggleOpen=(t=!this.open)=>{this.open=t,this.activeMenuItemIndex=-1,clearTimeout(this.menuFocusTimeout),t?this.menuFocusTimeout=window.setTimeout((()=>a(this.menuEl)),50):a(this.menuButtonEl)}}connectedCallback(){this.mutationObserver.observe(this.el,{childList:!0,subtree:!0}),this.getActions()}disconnectedCallback(){this.mutationObserver.disconnect()}expandedHandler(){this.open=!1}activeMenuItemIndexHandler(){this.updateActions(this.actionElements)}renderMenuButton(){const{menuButtonId:t,menuId:i,open:s,intlOptions:o,expanded:a}=this,n=o||"Options";return e("calcite-action",{active:s,"aria-controls":i,"aria-expanded":s.toString(),"aria-haspopup":"true",class:"menu-button",icon:"ellipsis",id:t,label:n,onClick:this.menuButtonClick,onKeyDown:this.menuButtonKeyDown,onKeyUp:this.menuButtonKeyUp,ref:this.setMenuButtonRef,text:n,textEnabled:a})}renderMenuItems(){const{actionElements:t,activeMenuItemIndex:i,open:s,menuButtonId:o,menuId:a,menuButtonEl:n,intlOptions:r,offsetDistance:l,placement:c}=this,p=t[i];return e("calcite-popover",{disablePointer:!0,label:r||"Options",offsetDistance:l,open:s,placement:c,referenceElement:n},e("div",{"aria-activedescendant":(null==p?void 0:p.id)||null,"aria-labelledby":o,class:"menu",id:a,onKeyDown:this.menuActionsContainerKeyDown,onKeyUp:this.menuActionsContainerKeyUp,ref:t=>this.menuEl=t,role:"menu",tabIndex:-1},e("slot",null)))}render(){return e(i,null,this.renderMenuButton(),this.renderMenuItems())}isValidKey(t,e){return!!e.find((e=>e===t))}get el(){return s(this)}static get watchers(){return{expanded:["expandedHandler"],activeMenuItemIndex:["activeMenuItemIndexHandler"]}}};w.style="@keyframes in{0%{opacity:0}100%{opacity:1}}@keyframes in-down{0%{opacity:0;transform:translate3D(0, -5px, 0)}100%{opacity:1;transform:translate3D(0, 0, 0)}}@keyframes in-up{0%{opacity:0;transform:translate3D(0, 5px, 0)}100%{opacity:1;transform:translate3D(0, 0, 0)}}@keyframes in-scale{0%{opacity:0;transform:scale3D(0.95, 0.95, 1)}100%{opacity:1;transform:scale3D(1, 1, 1)}}:host{box-sizing:border-box;background-color:var(--calcite-ui-foreground-1);color:var(--calcite-ui-text-2);font-size:var(--calcite-font-size--1)}:host *{box-sizing:border-box}:host{--calcite-icon-size:1rem;--calcite-spacing-quarter:0.25rem;--calcite-spacing-half:0.5rem;--calcite-spacing-three-quarters:0.75rem;--calcite-spacing:1rem;--calcite-spacing-plus-quarter:1.25rem;--calcite-spacing-plus-half:1.5rem;--calcite-spacing-double:2rem;--calcite-menu-min-width:10rem;--calcite-header-min-height:3rem;--calcite-footer-min-height:3rem}:root{--calcite-popper-transition:150ms ease-in-out}:host([hidden]){display:none}:host{display:flex;flex-direction:column}::slotted(calcite-action){display:flex;width:100%}.menu-button{align-self:stretch;flex:0 1 auto;height:100%;position:relative}.menu{min-width:var(--calcite-menu-min-width);flex-flow:column nowrap}";const k=class{constructor(e){t(this,e),this.calcitePopoverClose=o(this,"calcitePopoverClose",7),this.calcitePopoverOpen=o(this,"calcitePopoverOpen",7),this.closeButton=!1,this.disableFlip=!1,this.disablePointer=!1,this.offsetDistance=c,this.offsetSkidding=0,this.open=!1,this.placement="auto",this.intlClose=u.close,this._referenceElement=this.getReferenceElement(),this.guid="calcite-popover-"+r(),this.getId=()=>this.el.id||this.guid,this.setExpandedAttr=()=>{const{_referenceElement:t,open:e}=this;t&&t.setAttribute(f,e.toString())},this.addReferences=()=>{const{_referenceElement:t}=this;if(!t)return;const e=this.getId();t.setAttribute(b,e),t.setAttribute(x,e),this.setExpandedAttr()},this.removeReferences=()=>{const{_referenceElement:t}=this;t&&(t.removeAttribute(b),t.removeAttribute(x),t.removeAttribute(f))},this.hide=()=>{this.open=!1}}offsetDistanceOffsetHandler(){this.reposition()}offsetSkiddingHandler(){this.reposition()}openHandler(t){this.reposition(),this.setExpandedAttr(),t?this.calcitePopoverOpen.emit():this.calcitePopoverClose.emit()}placementHandler(){this.reposition()}referenceElementHandler(){this.removeReferences(),this._referenceElement=this.getReferenceElement(),this.addReferences(),this.createPopper()}componentDidLoad(){this.createPopper(),this.addReferences()}disconnectedCallback(){this.removeReferences(),this.destroyPopper()}async reposition(){const{popper:t,el:e,placement:i}=this,s=this.getModifiers();t?p({el:e,modifiers:s,placement:i,popper:t}):this.createPopper()}async setFocus(t){var e,i;"close-button"!==t?null===(i=this.el)||void 0===i||i.focus():null===(e=this.closeButtonEl)||void 0===e||e.focus()}async toggle(t=!this.open){this.open=t}getReferenceElement(){const{referenceElement:t}=this;return("string"==typeof t?document.getElementById(t):t)||null}getModifiers(){const{arrowEl:t,flipPlacements:e,disableFlip:i,disablePointer:s,offsetDistance:o,offsetSkidding:a}=this,n={name:"flip",enabled:!i};e&&(n.options={fallbackPlacements:e});const r={name:"arrow",enabled:!s};return t&&(r.options={element:t}),[r,n,{name:"offset",enabled:!0,options:{offset:[a,o]}}]}createPopper(){this.destroyPopper();const{el:t,placement:e,_referenceElement:i}=this,s=this.getModifiers();this.popper=h({el:t,modifiers:s,placement:e,referenceEl:i})}destroyPopper(){const{popper:t}=this;t&&t.destroy(),this.popper=null}renderImage(){return this.el.querySelector("[slot=image]")?e("div",{class:g.imageContainer},e("slot",{name:"image"})):null}renderCloseButton(){const{closeButton:t,intlClose:i}=this;return t?e("button",{"aria-label":i,class:{[g.closeButton]:!0},onClick:this.hide,ref:t=>this.closeButtonEl=t,title:i},e("calcite-icon",{icon:"x",scale:"m"})):null}render(){const{_referenceElement:t,el:s,label:o,open:a,disablePointer:r}=this,c="rtl"===n(s),p=t&&a,h=!p,m=r?null:e("div",{class:g.arrow,ref:t=>this.arrowEl=t});return e(i,{"aria-hidden":h.toString(),"aria-label":o,"calcite-hydrated-hidden":h,id:this.getId(),role:"dialog"},e("div",{class:{[l.rtl]:c,[d.animation]:!0,[d.animationActive]:p}},m,e("div",{class:g.container},this.renderImage(),e("div",{class:g.content},e("slot",null),this.renderCloseButton()))))}get el(){return s(this)}static get watchers(){return{offsetDistance:["offsetDistanceOffsetHandler"],offsetSkidding:["offsetSkiddingHandler"],open:["openHandler"],placement:["placementHandler"],referenceElement:["referenceElementHandler"]}}};k.style='@keyframes in{0%{opacity:0}100%{opacity:1}}@keyframes in-down{0%{opacity:0;transform:translate3D(0, -5px, 0)}100%{opacity:1;transform:translate3D(0, 0, 0)}}@keyframes in-up{0%{opacity:0;transform:translate3D(0, 5px, 0)}100%{opacity:1;transform:translate3D(0, 0, 0)}}@keyframes in-scale{0%{opacity:0;transform:scale3D(0.95, 0.95, 1)}100%{opacity:1;transform:scale3D(1, 1, 1)}}:root{--calcite-popper-transition:150ms ease-in-out}:host([hidden]){display:none}:host{display:block;position:absolute;z-index:900;transform:scale(0)}.calcite-popper-anim{position:relative;z-index:1;transition:var(--calcite-popper-transition);visibility:hidden;transition-property:transform, visibility, opacity;opacity:0;box-shadow:0 0 16px 0 rgba(0, 0, 0, 0.16);border-radius:var(--calcite-border-radius)}:host([data-popper-placement^=bottom]) .calcite-popper-anim{transform:translateY(-5px)}:host([data-popper-placement^=top]) .calcite-popper-anim{transform:translateY(5px)}:host([data-popper-placement^=left]) .calcite-popper-anim{transform:translateX(5px)}:host([data-popper-placement^=right]) .calcite-popper-anim{transform:translateX(-5px)}:host([data-popper-placement]) .calcite-popper-anim--active{opacity:1;visibility:visible;transform:translate(0)}.arrow,.arrow::before{position:absolute;width:8px;height:8px;z-index:-1}.arrow::before{content:"";box-shadow:0 4px 8px -1px rgba(0, 0, 0, 0.08), 0 2px 4px -1px rgba(0, 0, 0, 0.04);transform:rotate(45deg);background:var(--calcite-ui-foreground-1)}:host([data-popper-placement^=top]) .arrow{bottom:-4px}:host([data-popper-placement^=bottom]) .arrow{top:-4px}:host([data-popper-placement^=left]) .arrow{right:-4px}:host([data-popper-placement^=right]) .arrow{left:-4px}:host{pointer-events:none}:host([open]){pointer-events:initial}.container{background-color:var(--calcite-ui-foreground-1);position:relative;display:flex;overflow:hidden;flex-wrap:nowrap;flex-direction:column;color:var(--calcite-ui-text-1)}.content{display:flex;flex-direction:row;justify-content:space-between;justify-content:flex-start;line-height:1.5rem}.close-button{outline-offset:0;outline-color:transparent;transition:outline-offset 100ms ease-in-out, outline-color 100ms ease-in-out}.close-button:focus{outline:2px solid var(--calcite-ui-brand);outline-offset:-2px}.close-button{display:block;padding:0.75rem;border-style:none;color:var(--calcite-ui-text-1);cursor:pointer;background-color:var(--calcite-ui-foreground-1);flex:0 0 auto;border-radius:0 var(--calcite-border-radius) 0 0;z-index:1}.close-button:hover{background-color:var(--calcite-ui-foreground-2)}.close-button:active{background-color:var(--calcite-ui-foreground-3)}.calcite--rtl .close-button{border-radius:var(--calcite-border-radius) 0 0 0}.image-container{overflow:hidden;max-height:200px;margin:5px}slot[name=image]::slotted(img){height:auto;width:100%;object-fit:cover;max-height:200px;object-position:50% 50%}::slotted(calcite-panel),::slotted(calcite-flow){height:100%}';export{w as calcite_action_menu,k as calcite_popover}