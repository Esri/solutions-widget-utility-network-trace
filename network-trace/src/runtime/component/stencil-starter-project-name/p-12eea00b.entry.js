import{r as t,c as s,h as i,g as e}from"./p-551d452f.js";import{g as r,f as n}from"./p-ddb29161.js";import{g as a}from"./p-4bacf9d8.js";import{n as o,i as l,a as c,r as h,h as p,b as u}from"./p-23057e5c.js";import{c as m}from"./p-5852966b.js";import{T as d}from"./p-9f9d8725.js";const f=m(),g=class{constructor(i){t(this,i),this.calciteColorPickerHexInputChange=s(this,"calciteColorPickerHexInputChange",7),this.allowEmpty=!1,this.intlHex=d.hex,this.intlNoColor=d.noColor,this.scale="m",this.theme="light",this.value=o(f.hex()),this.onCalciteInputBlur=t=>{const s=t.currentTarget,i=s.value,e="#"+i;this.allowEmpty&&!i||l(e)&&c(e)||(s.value=this.allowEmpty&&!this.internalColor?"":this.formatForInternalInput(h(this.internalColor.object())))},this.onInputChange=t=>{const s=t.currentTarget.value;let i;if(s){const t=s;if(!p("#"+t))return;i=o(t)}else this.allowEmpty&&(i=null);this.value=i,this.calciteColorPickerHexInputChange.emit()},this.onInputKeyDown=t=>{const{altKey:s,ctrlKey:i,metaKey:e,shiftKey:r}=t,{inputNode:n,internalColor:l,value:c}=this,h=a(t.key);if(c&&("ArrowDown"===h||"ArrowUp"===h))return this.value=o(this.nudgeRGBChannels(l,(r?10:1)*("ArrowUp"===h?1:-1)).hex()),void t.preventDefault();const p=s||i||e,m=n.value.length>=6,d="Range"===getSelection().type;1!==h.length||p||d||u.test(h)&&!m||t.preventDefault()},this.internalColor=f,this.storeInputRef=t=>{this.inputNode=t}}connectedCallback(){const{allowEmpty:t,value:s}=this;if(s){const t=o(s);l(t)&&(this.internalColor=m(t),this.value=t)}else t&&(this.internalColor=null,this.value=null)}handleValueChange(t,s){if(t){const s=o(t);if(l(s)){const{internalColor:t}=this,i=!t||s!==o(t.hex());return this.internalColor=m(s),this.value=s,void(i&&this.calciteColorPickerHexInputChange.emit())}}else if(this.allowEmpty)return this.internalColor=null,this.value=null,void this.calciteColorPickerHexInputChange.emit();this.value=s}render(){const{el:t,intlHex:s,value:e}=this,n=this.formatForInternalInput(e),a=r(t);return i("div",{class:"container"},i("calcite-input",{"aria-label":s,class:"input",dir:a,onCalciteInputBlur:this.onCalciteInputBlur,onChange:this.onInputChange,onKeyDown:this.onInputKeyDown,prefixText:"#",ref:this.storeInputRef,scale:"s",value:n}),n?i("calcite-color-picker-swatch",{active:!0,class:"preview",color:"#"+n,scale:"s"}):null)}async setFocus(){n(this.inputNode)}formatForInternalInput(t){return t?t.replace("#",""):""}nudgeRGBChannels(t,s){return m.rgb(t.array().map((t=>t+s)))}get el(){return e(this)}static get watchers(){return{value:["handleValueChange"]}}};g.style="@keyframes in{0%{opacity:0}100%{opacity:1}}@keyframes in-down{0%{opacity:0;transform:translate3D(0, -5px, 0)}100%{opacity:1;transform:translate3D(0, 0, 0)}}@keyframes in-up{0%{opacity:0;transform:translate3D(0, 5px, 0)}100%{opacity:1;transform:translate3D(0, 0, 0)}}@keyframes in-scale{0%{opacity:0;transform:scale3D(0.95, 0.95, 1)}100%{opacity:1;transform:scale3D(1, 1, 1)}}:root{--calcite-popper-transition:150ms ease-in-out}:host([hidden]){display:none}:host{display:block}.container{width:100%;display:-ms-inline-grid;display:inline-grid;-ms-grid-columns:1fr auto;grid-template-columns:1fr auto;align-items:center}.preview{-ms-grid-column:2;-ms-grid-column-span:1;grid-column:2/3;display:flex;align-items:center;pointer-events:none;margin:0 6px;z-index:1}.preview,.input{-ms-grid-row:1;grid-row:1}.input{-ms-grid-column:1;-ms-grid-column-span:2;grid-column:1/3;text-transform:uppercase;width:100%}";export{g as calcite_color_picker_hex_input}